(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{25:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var o=n(1),c=n.n(o),a=n(17),s=n.n(a),r=(n(24),n(25),n(2)),l=n(8),i=n(3),u=n(0),j=function(){var e=Object(o.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1];return Object(o.useEffect)((function(){null!==localStorage.getItem("token")&&c(!0)}),[]),Object(u.jsx)("nav",{className:"mb-1 bg-dark p-1 w-100",children:!0===n?Object(u.jsxs)(o.Fragment,{children:[" ",Object(u.jsx)(l.b,{to:"/",children:"Home"}),Object(u.jsx)("span",{children:" | "}),Object(u.jsx)(l.b,{to:"/logout",children:"Logout"}),Object(u.jsx)("span",{children:" | "}),Object(u.jsx)(l.b,{to:"/post-news",children:"Post"})]}):Object(u.jsxs)(o.Fragment,{children:[" ",Object(u.jsx)(l.b,{to:"/login",children:"Login"}),Object(u.jsx)("span",{children:" | "}),Object(u.jsx)(l.b,{to:"/signup",children:"Signup"}),Object(u.jsx)("span",{children:" | "}),Object(u.jsx)(l.b,{to:"/",children:"Home"})]})})},b=function(e){var t=Object(o.useState)(""),n=Object(r.a)(t,2),c=(n[0],n[1],Object(o.useState)("")),a=Object(r.a)(c,2),s=a[0],l=a[1],i=Object(o.useState)(""),j=Object(r.a)(i,2),b=j[0],d=j[1],m=Object(o.useState)(!1),p=Object(r.a)(m,2),h=p[0],O=p[1],f=Object(o.useState)(!0),g=Object(r.a)(f,2),x=g[0],S=g[1];Object(o.useEffect)((function(){null!==localStorage.getItem("token")?window.location.replace("/"):S(!1)}),[]);return Object(u.jsxs)("div",{children:[!1===x&&Object(u.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={username:s,password:b};fetch("/api/users/auth/login/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.key?(localStorage.clear(),localStorage.setItem("token",e.key),localStorage.setItem("userId",e.user.id),window.location.replace("/")):(l(""),d(""),localStorage.clear(),O(!0))}))},className:"mt-1",children:[Object(u.jsx)("label",{htmlFor:"username",children:"Username:"}),Object(u.jsx)("input",{className:"mx-1",name:"username",type:"text",value:s,required:!0,onChange:function(e){return l(e.target.value)}})," ",Object(u.jsx)("label",{htmlFor:"password",children:"Password:"}),Object(u.jsx)("input",{className:"mx-1",name:"password",type:"password",value:b,required:!0,onChange:function(e){return d(e.target.value)}})," ",Object(u.jsx)("input",{type:"submit",value:"Login"})]}),!0===h&&Object(u.jsx)("section",{children:"Cannot log in with provided credentials"})]})},d=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1],a=Object(o.useState)(""),s=Object(r.a)(a,2),l=s[0],i=s[1],j=Object(o.useState)(""),b=Object(r.a)(j,2),d=b[0],m=b[1],p=Object(o.useState)(!1),h=Object(r.a)(p,2),O=h[0],f=h[1],g=Object(o.useState)(!0),x=Object(r.a)(g,2),S=x[0],v=x[1];Object(o.useEffect)((function(){null!==localStorage.getItem("token")?window.location.replace("/dashboard"):v(!1)}),[]);return Object(u.jsxs)("div",{children:[!1===S&&Object(u.jsx)("h1",{children:"Signup"}),!0===O&&Object(u.jsx)("h2",{children:"Cannot signup with provided credentials"}),Object(u.jsxs)("form",{onSubmit:function(e){e.preventDefault();var t={username:n,password1:l,password2:d};fetch("/api/users/auth/register/",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(e){e.key?(localStorage.clear(),localStorage.setItem("token",e.key),localStorage.setItem("userId",e.user.id),window.location.replace("/")):(c(""),i(""),m(""),localStorage.clear(),f(!0))}))},children:[Object(u.jsx)("label",{htmlFor:"username",children:"Username:"})," ",Object(u.jsx)("br",{}),Object(u.jsx)("input",{name:"username",type:"username",value:n,onChange:function(e){return c(e.target.value)},required:!0})," ",Object(u.jsx)("br",{}),Object(u.jsx)("label",{htmlFor:"password1",children:"Password:"})," ",Object(u.jsx)("br",{}),Object(u.jsx)("input",{name:"password1",type:"password",value:l,onChange:function(e){return i(e.target.value)},required:!0})," ",Object(u.jsx)("br",{}),Object(u.jsx)("label",{htmlFor:"password2",children:"Confirm password:"})," ",Object(u.jsx)("br",{}),Object(u.jsx)("input",{name:"password2",type:"password",value:d,onChange:function(e){return m(e.target.value)},required:!0})," ",Object(u.jsx)("br",{}),Object(u.jsx)("input",{className:"my-1",type:"submit",value:"Signup"})]})]})},m=function(){var e=Object(o.useState)(!0),t=Object(r.a)(e,2),n=t[0],c=t[1];Object(o.useEffect)((function(){null==localStorage.getItem("token")?window.location.replace("/login"):c(!1)}),[]);return Object(u.jsx)("div",{children:!1===n&&Object(u.jsxs)(o.Fragment,{children:[Object(u.jsx)("h4",{children:"Are you sure you want to logout?"}),Object(u.jsx)("input",{type:"button",value:"Logout",onClick:function(e){e.preventDefault(),fetch("/api/users/auth/logout/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){console.log(e),localStorage.clear(),window.location.replace("/login")}))}})]})})},p=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=(t[0],t[1],Object(o.useState)("")),c=Object(r.a)(n,2),a=(c[0],c[1]),s=Object(o.useState)({}),l=Object(r.a)(s,2),i=l[0],j=l[1],b=Object(o.useState)(!0),d=Object(r.a)(b,2),m=d[0],p=d[1];return Object(o.useEffect)((function(){null===localStorage.getItem("token")||fetch("/api/users/auth/user/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){console.log(e),a(e.username),localStorage.setItem("favorites",e.favorites),console.log("dashboard favorites: ",localStorage.getItem("favorites"))})),fetch("/api/data/news/",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e),j(e.reverse()),p(!1)}))}),[]),Object(u.jsx)("div",{className:"d-flex flex-column align-items-center",children:!1===m&&Object(u.jsx)(o.Fragment,{children:Object(u.jsx)("div",{className:"col-12 col-sm-10 col-md-10",children:i.map((function(e){return Object(u.jsxs)("div",{className:"bg-secondary py-1 px-2 rounded my-1",children:[Object(u.jsx)("a",{className:"postLinks",href:"http://".concat(e.url),children:e.title}),Object(u.jsx)("span",{children:"  "}),Object(u.jsx)("a",{className:"commentLinks",style:{fontSize:"0.8rem"},href:"news/".concat(e.id),children:"Comments"})]},e.id)}))})})})},h=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=(t[0],t[1],Object(o.useState)("")),c=Object(r.a)(n,2),a=c[0],s=c[1],l=Object(o.useState)(""),i=Object(r.a)(l,2),j=i[0],b=i[1];return Object(u.jsx)(o.Fragment,{children:Object(u.jsx)("div",{className:"mt-2",children:Object(u.jsxs)("form",{onSubmit:function(e){e.preventDefault(),console.log("post going"),null===localStorage.getItem("token")?window.location.replace("/login"):fetch("/api/data/news/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))},body:JSON.stringify({title:a,url:j})}).then((function(e){return e.json()})).then((function(e){console.log(e),e.id&&window.location.replace("/")}))},className:"m-1",children:[Object(u.jsx)("label",{htmlFor:"title",children:"Title:"}),Object(u.jsx)("input",{className:"mx-1",name:"title",type:"text",value:a,required:!0,onChange:function(e){return s(e.target.value)}})," ",Object(u.jsx)("label",{htmlFor:"url",children:"Url:"}),Object(u.jsx)("input",{className:"mx-1",name:"url",type:"text",value:j,required:!0,onChange:function(e){return b(e.target.value)}})," ",Object(u.jsx)("input",{className:"",type:"submit",value:"Post"})]})})})},O=n(9),f=function(e){var t=Object(o.useState)(!1),n=Object(r.a)(t,2),c=(n[0],n[1],Object(o.useState)("")),a=Object(r.a)(c,2),s=a[0],l=a[1];return Object(o.useEffect)((function(){}),[]),Object(u.jsxs)("form",{className:"ms-3 mt-1",onSubmit:function(t){t.preventDefault(),console.log(s),console.log("comment going"),null===localStorage.getItem("token")?window.location.replace("/login"):fetch("/api/users/auth/user/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(t){var n={text:s,user:t.id,newspost:e.postId,replyTo:e.replyTo};return console.log(n),n})).then((function(t){fetch("/api/data/comment/",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))},body:JSON.stringify(t)}).then((function(e){return e.json()})).then((function(t){if(console.log(t),l(""),t.id&&!e.mainPage){fetch("/api/data/comment/".concat(e.replyTo,"/"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))},body:JSON.stringify({hasReplies:!0})}).then((function(){e.cancelButton(),console.log(e.replyTo,e.postId),e.onNewComment(e.replyTo,e.postId,!0)}))}else e.onNewComment(e.replyTo,e.postId,!0)}))}))},children:[Object(u.jsx)("textarea",{name:"comment",id:"comment",required:!0,value:s,onChange:function(e){return l(e.target.value)},rows:"5",cols:"40"}),Object(u.jsx)("br",{}),Object(u.jsx)("button",{className:"btn btn-sm btn-primary",type:"submit",children:"add comment"}),Object(u.jsx)("span",{children:" "}),e.mainPage?"":Object(u.jsx)("button",{className:"btn btn-sm btn-danger",onClick:e.cancelButton,children:"cancel"})]})},g=function(e){var t=Object(o.useState)(!1),n=Object(r.a)(t,2),c=(n[0],n[1],Object(o.useState)({})),a=Object(r.a)(c,2),s=a[0],l=a[1],i=Object(o.useState)(""),j=Object(r.a)(i,2),b=j[0],d=j[1],m=Object(o.useState)(""),p=Object(r.a)(m,2),h=p[0],g=p[1],S=Object(o.useState)(!0),v=Object(r.a)(S,2),y=v[0],w=v[1],k=Object(o.useState)(localStorage.getItem("userId")),I=Object(r.a)(k,2),T=I[0];I[1];function C(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];console.log("show replies for: ",t),fetch("/api/data/comment/?newspost=".concat(n,"&replyTo=").concat(t)).then((function(e){return console.log(e),e.json()})).then((function(n){if(console.log("repliesToComment: ",n),Object.keys(n).length>0)h!=t||o?w(!0):(console.log("toggle enabled"),w(!y)),l(n.reverse()),console.log("replies: ",s),g(t),d(""),o&&(console.log("update mode comment id: ",t),e.onNewPost(t));else if(o){fetch("/api/data/comment/".concat(t,"/"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))},body:JSON.stringify({hasReplies:!1})}).then((function(){g("");var n=s.filter((function(e){return e==t}));e.onCommentDelete(n.replyTo,e.postId,!0)}))}}))}function N(){d("")}return Object.keys(e.comments).length>0?e.comments.map((function(t,n){return Object(u.jsxs)("div",{className:"m-2 ms-3",children:[Object(u.jsxs)("section",{className:"commentHeader",style:{backgroundColor:"black",color:"white",alignSelf:"flex-start",display:"inline-block"},children:[t.customuser," - ",t.comment_date]}),Object(u.jsx)("div",{className:"py-1",children:t.text}),Object(u.jsx)("button",{className:"btn btn-sm btn-primary",onClick:function(){return e=t.id,console.log(e),g(""),void d(e);var e},children:"reply"}),Object(u.jsx)("span",{children:" "}),t.hasReplies?Object(u.jsx)("button",{className:"btn btn-sm btn-primary",onClick:function(){C(t.id,e.postId)},children:"view replies"}):"",Object(u.jsx)("span",{children:" "}),t.user==T?Object(u.jsx)("button",{className:"btn btn-sm btn-danger",onClick:function(){var n,o;n=t.id,o=t.replyTo,fetch("/api/data/comment/".concat(n,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(t){console.log("delete reply: ",t),e.onCommentDelete(o,e.postId,!0)}))},children:"delete"}):"",h==t.id&&y?Object(u.jsx)(x,{onNewPost:function(e){return function(e){var t=Object(O.a)(s),n=t.findIndex((function(t){return t.id==e}));console.log("commentIndexUpdate: ",n),t[n].hasReplies=!0,l(t)}(e)},onCommentDelete:function(e,t,n){return C(e,t,n)},comments:s,postId:e.postId}):"",b==t.id?Object(u.jsx)(f,{onNewComment:function(e,t,n){return C(e,t,n)},cancelButton:N,postId:e.postId,replyTo:t.id}):""]},t.id)})):""},x=function(e){var t=Object(o.useState)(!1),n=Object(r.a)(t,2),c=(n[0],n[1],Object(o.useState)({})),a=Object(r.a)(c,2),s=a[0],l=a[1],i=Object(o.useState)(""),j=Object(r.a)(i,2),b=j[0],d=j[1],m=Object(o.useState)(""),p=Object(r.a)(m,2),h=p[0],x=p[1],S=Object(o.useState)(!0),v=Object(r.a)(S,2),y=v[0],w=v[1],k=Object(o.useState)(localStorage.getItem("userId")),I=Object(r.a)(k,2),T=I[0];I[1];function C(t,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];console.log("show replies for: ",t),fetch("/api/data/comment/?newspost=".concat(n,"&replyTo=").concat(t)).then((function(e){return console.log(e),e.json()})).then((function(n){if(console.log("repliesToComment: ",n),Object.keys(n).length>0)h!=t||o?w(!0):(console.log("toggle enabled"),w(!y)),l(n.reverse()),console.log("replies: ",s),x(t),d(""),o&&(console.log("update mode comment id: ",t),e.onNewPost(t));else if(o){fetch("/api/data/comment/".concat(t,"/"),{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))},body:JSON.stringify({hasReplies:!1})}).then((function(){x("");var n=s.filter((function(e){return e==t}));e.onCommentDelete(n.replyTo,e.postId,!0)}))}}))}function N(){d("")}return Object(o.useEffect)((function(){}),[]),Object.keys(e.comments).length>0?e.comments.map((function(t,n){return Object(u.jsxs)("div",{className:"m-2 ms-3",children:[Object(u.jsxs)("section",{className:"commentHeader",style:{backgroundColor:"black",color:"white",alignSelf:"flex-start",display:"inline-block"},children:[t.customuser," - ",t.comment_date]}),Object(u.jsx)("div",{className:"py-1",children:t.text}),Object(u.jsx)("button",{className:"btn btn-sm btn-primary",onClick:function(){return e=t.id,console.log(e),x(""),void d(e);var e},children:"reply"}),Object(u.jsx)("span",{children:" "}),t.hasReplies?Object(u.jsx)("button",{className:"btn btn-sm btn-primary",onClick:function(){C(t.id,e.postId)},children:"view replies"}):"",Object(u.jsx)("span",{children:" "}),t.user==T?Object(u.jsx)("button",{className:"btn btn-sm btn-danger",onClick:function(){var n,o;n=t.id,o=t.replyTo,fetch("/api/data/comment/".concat(n,"/"),{method:"DELETE",headers:{Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(t){console.log(t),e.onCommentDelete(o,e.postId,!0)}))},children:"delete"}):"",h==t.id&&y?Object(u.jsx)(g,{onNewPost:function(e){return function(e){var t=Object(O.a)(s),n=t.findIndex((function(t){return t.id==e}));console.log("commentIndexUpdate: ",n),t[n].hasReplies=!0,l(t)}(e)},onCommentDelete:function(e,t,n){return C(e,t,n)},comments:s,postId:e.postId}):"",b==t.id?Object(u.jsx)(f,{onNewComment:function(e,t,n){return C(e,t,n)},cancelButton:N,postId:e.postId,replyTo:t.id}):""]},t.id)})):""};var S=function(){var e=Object(o.useState)(!0),t=Object(r.a)(e,2),n=(t[0],t[1]),c=Object(o.useState)(function(){var e=Object(i.f)().id;return console.log("id: ",e),e}()),a=Object(r.a)(c,2),s=a[0],l=(a[1],Object(o.useState)({})),j=Object(r.a)(l,2),b=j[0],d=j[1],m=Object(o.useState)({}),p=Object(r.a)(m,2),h=p[0],g=p[1],S=Object(o.useState)("0"),v=Object(r.a)(S,2),y=(v[0],v[1],Object(o.useState)("vote")),w=Object(r.a)(y,2),k=w[0],I=w[1],T=Object(o.useState)(localStorage.getItem("favorites").split(",")),C=Object(r.a)(T,2),N=C[0],P=C[1];function E(e){fetch("/api/data/news/".concat(e,"/")).then((function(e){return e.json()})).then((function(e){console.log("dataOfPost: ",e),d(e)})).then((function(){fetch("/api/data/comment/?newspost=".concat(e)).then((function(e){return console.log(e),e.json()})).then((function(e){console.log("commentsOfPost: ",e),g(e.reverse()),n(!1)})).catch((function(e){return console.log("error for comment: ",e)}))})).catch((function(e){window.location.reload(),console.log(e,"there is error")}))}return Object(o.useEffect)((function(){E(s)}),[]),Object(o.useEffect)((function(){localStorage.setItem("favorites",N.join()),console.log("favorites: ",N),N.includes(s.toString())?I("vote on"):I("vote")}),[N,b]),Object(u.jsx)("div",{children:Object(u.jsxs)(o.Fragment,{children:[Object(u.jsx)("div",{className:"col-md-8",children:Object(u.jsxs)("h4",{children:[Object(u.jsx)("a",{className:"postRenderLinks",href:"".concat(b.url),children:b.title}),Object(u.jsx)("span",{onClick:function(){"vote"==k?fetch("/api/data/news/".concat(s,"/?vote=up"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){console.log("response from vote up:",e),b.point=e.point,P([].concat(Object(O.a)(N),[s]))})):fetch("/api/data/news/".concat(s,"/?vote=down"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Token ".concat(localStorage.getItem("token"))}}).then((function(e){return e.json()})).then((function(e){b.point=e.point,console.log("postId when removing: ",s);var t=N.filter((function(e){return e!=s}));P(t)}))},className:k})," ",Object(u.jsx)("small",{className:"mx-2",children:b.point})]})}),Object(u.jsx)(f,{onNewComment:function(e,t){return E(t)},mainPage:!0,postId:s}),Object(u.jsx)(x,{onNewPost:function(e){return function(e){var t=Object(O.a)(h),n=t.findIndex((function(t){return t.id==e}));console.log("commentIndexUpdate: ",n),t[n].hasReplies=!0,g(t)}(e)},onCommentDelete:function(e,t,n){return E(t)},comments:h,postId:s})]})})},v=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=t[0],c=(t[1],Object(o.useState)("")),a=Object(r.a)(c,2),s=(a[0],a[1],Object(o.useState)(!1)),O=Object(r.a)(s,2),f=(O[0],O[1],Object(o.useState)(!0)),g=Object(r.a)(f,2),x=(g[0],g[1],function(e,t){});return Object(o.useEffect)((function(){console.log(n)})),Object(u.jsx)("div",{className:"App",children:Object(u.jsx)(l.a,{children:Object(u.jsxs)("div",{className:"mx-2 mt-1",children:[Object(u.jsx)(j,{}),Object(u.jsxs)(i.c,{children:[Object(u.jsx)(i.a,{path:"/login",component:function(){return Object(u.jsx)(b,{onSubmit:x})},exact:!0}),Object(u.jsx)(i.a,{path:"/signup",component:d,exact:!0}),Object(u.jsx)(i.a,{path:"/logout",component:m,exact:!0}),Object(u.jsx)(i.a,{path:"/",component:p,exact:!0}),Object(u.jsx)(i.a,{path:"/post-news",component:h,exact:!0}),Object(u.jsx)(i.a,{path:"/news/:id",component:S,exact:!0})]})]})})})},y=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,36)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),o(e),c(e),a(e),s(e)}))};s.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(v,{})}),document.getElementById("root")),y()}},[[35,1,2]]]);
//# sourceMappingURL=main.3a41e167.chunk.js.map